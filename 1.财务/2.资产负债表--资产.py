import os,sys 
parentdir = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) 
sys.path.insert(0,parentdir) 

import xmind
from xmind.core.markerref import MarkerId
xmind_name="资产负债表"
w = xmind.load(os.path.dirname(os.path.abspath(__file__))+"\\"+xmind_name+".xmind") 
s2=w.createSheet()
s2.setTitle("资产负债表--资产")
r2=s2.getRootTopic()
r2.setTitle("资产负债表--资产")


content={
'货币资金':[
    '<<短期负债',
    '充裕，却借了很多高息负债',
    '定存多，流动资金少',
    '其他货币资金额大，无解释'
],
'经营相关资产':[
    '利润表中的营收，不记增值税，但资产负债表记',
    {'应收票据':[
        '银行承兑汇票：可信度大,可贴现',
        '商业承兑汇票：可信度略低'
    ]},
    {'应收账款':[
        '报表中的都是减过坏账准备的净值',
        {'过多':[
            '赊销严重，存在风险',
            '大幅增长，幅度超过收入增长',
            '回款速度低于行业平均水平',
            '占收入比例超过三成，且多为一年以上'
        ]},
        {'过少':[
            '虚假收入，没啥销量'
        ]},
        {'需计提坏账准备':[
            '资产负债表->资产损失',
            '利润表->费用'
        ]},
    ]},
    {'预付账款':[
        '预付款数量增加，流出资金，以营业收入重回公司增加利润',
        '预付款时间增加，可能将公司资金挪为他用',
        '注意占营业收入，营业成本的比例'
    ]},
    '应收利息和应收股利',
    {'其他应收款':[
        '极小为零，如较大，经营不规范'
    ]},
    {'长期应收款':[
        '融资租赁',
        '递延方式分期收款'
    ]},
    {'存货':[
        '计提跌价准备',
        '虚购商品采购流出资金，再将资金流回企业，虚增利润(存货增长>>成本增长)',
        '存货增长，成本下降，毛利率上升，虚增本期利润'
    ]},
    {'生产性生物资产':[
        '用于消耗，进入存货',
        '用于生成，进入资产',
    ]},
],
'生产相关资产':[
    {'固定资产':[
        '需计提折旧->费用->从利润表里扣除',
        '年末减值测试->费用->从利润表里扣除',
        '折旧政策',
        '折旧不意味着资产产生损失，如大坝，白酒'
    ]},
    {'在建工程':[
        '消耗工程物资，创造固定资产',
        '无需折旧',
        '数目大，迟迟不转固定资产，有风险'
    ]},
    {'无形资产':[
        '摊销==折旧',
        '研究:管理费用',
        '开发:管理费用or无形资产'
    ]},
    {'商誉':[
        '自创商誉不允许记录在报表',
        '只来自收购',
        '不用摊销，但需计提减值准备，从利润表中扣除',
        '一般收购，做低实物资产，减少摊销，提高利润'
    ]},
    {'长期待摊费用':[
        '费用->长期待摊费用:费用资本化',
    ]},
    {'递延所得税资产和负债':[
        '递延所得税资产：多交的',
        '递延所得税负债：少交的，对股东有利，推迟纳税'
    ]},
],
'投资相关资产':[
    {'交易性金融资产':[
        '采用公允价值计量',
        '股利或利息'
    ]},
    {'持有到期的资产':[
        '按实际利率计算的投资收益',
        '减值损失'
    ]},
    {'可供出售金融资产':[
        '汇总损益',
        '股利或利息',
        '减值损失'
    ]},
    {'长期股权投资':[
        '成本法：分红对利润产生影响',
        '权益法：经营盈亏对利润产生影响'
    ]}
]
}
#构建xmind
xmind.build(content,r2)
#保存xmind
xmind.save(w,os.path.dirname(os.path.abspath(__file__))+"\\"+xmind_name+".xmind") 